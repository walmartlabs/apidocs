<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>com.walmartlabs.lacinia.schema documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">com.walmartlabs/lacinia</span> <span class="project-version">1.2-alpha-3</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>com</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>walmartlabs</span></div></div></li><li class="depth-3"><a href="com.walmartlabs.lacinia.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lacinia</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.executor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>executor</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.expound.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>expound</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.federation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>federation</span></div></a></li><li class="depth-4"><a href="com.walmartlabs.lacinia.parser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parser</span></div></a></li><li class="depth-5 branch"><a href="com.walmartlabs.lacinia.parser.docs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>docs</span></div></a></li><li class="depth-5"><a href="com.walmartlabs.lacinia.parser.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.resolve.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>resolve</span></div></a></li><li class="depth-4 branch current"><a href="com.walmartlabs.lacinia.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.selection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>selection</span></div></a></li><li class="depth-4 branch"><a href="com.walmartlabs.lacinia.tracing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tracing</span></div></a></li><li class="depth-4"><a href="com.walmartlabs.lacinia.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-*verbose-schema-printing*"><div class="inner"><span>*verbose-schema-printing*</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-as-conformer"><div class="inner"><span>as-conformer</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-can-reach-null-producer.3F"><div class="inner"><span>can-reach-null-producer?</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-coercion-failure"><div class="inner"><span>coercion-failure</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-compile"><div class="inner"><span>compile</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-default-executor"><div class="inner"><span>default-executor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-default-field-resolver"><div class="inner"><span>default-field-resolver</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-default-scalar-transformers"><div class="inner"><span>default-scalar-transformers</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-hyphenating-default-field-resolver"><div class="inner"><span>hyphenating-default-field-resolver</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-is-coercion-failure.3F"><div class="inner"><span>is-coercion-failure?</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-select-type"><div class="inner"><span>select-type</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.schema.html#var-tag-with-type"><div class="inner"><span>tag-with-type</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">com.walmartlabs.lacinia.schema</h1><div class="doc"><div class="markdown"><p>Responsible for constructing and validating the GraphQL schema.</p>
<p>GraphQL schema starts in a format easy to read and maintain as an EDN file.</p>
<p>Compiling the schema performs a number of validations and reorganizations to make query execution faster and simpler, such as generating a flatter structure for the schema, and pre-computing many defaults.</p>
</div></div><div class="public anchor" id="var-*verbose-schema-printing*"><h3>*verbose-schema-printing*</h3><h4 class="dynamic">dynamic</h4><h4 class="added">added in 0.25.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>If bound to true, then the compiled schema prints and pretty-prints like an ordinary map, which is sometimes useful during development. When false (the default) the schema output is just a placeholder.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L2070">view source</a></div></div><div class="public anchor" id="var-as-conformer"><h3>as-conformer</h3><h4 class="deprecated">deprecated in 0.31.0</h4><div class="usage"><code>(as-conformer f)</code></div><div class="doc"><div class="markdown"><p>Creates a clojure.spec/conformer as a wrapper around the supplied function.</p>
<p>The function is only invoked if the value to be conformed is non-nil.</p>
<p>Any exception thrown by the function is silently caught and the returned conformer will return :clojure.spec/invalid or a <a href="com.walmartlabs.lacinia.schema.html#var-coercion-failure">coercion-failure</a>.</p>
<p>This function has been deprecated, as Scalar parse and serialize callbacks are now simple functions, and not conformers.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L163">view source</a></div></div><div class="public anchor" id="var-can-reach-null-producer.3F"><h3>can-reach-null-producer?</h3><div class="usage"><code>(can-reach-null-producer? schema element-def)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L886">view source</a></div></div><div class="public anchor" id="var-coercion-failure"><h3>coercion-failure</h3><h4 class="added">added in 0.16.0</h4><h4 class="deprecated">deprecated in 0.32.0</h4><div class="usage"><code>(coercion-failure message)</code><code>(coercion-failure message data)</code></div><div class="doc"><div class="markdown"><p>Returns a special record that indicates a failure coercing a scalar value. This may be returned from a scalar’s :parse or :serialize callback.</p>
<p>This is deprecated in version 0.32.0; just throw an exception instead.</p>
<p>A coercion failure includes a message key, and may also include additional data.</p>
<dl>
<dt>message</dt>
<dd>A message string presentable to a user.</dd>
<dt>data</dt>
<dd>An optional map of additional details about the failure.</dd>
</dl>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L81">view source</a></div></div><div class="public anchor" id="var-compile"><h3>compile</h3><div class="usage"><code>(compile schema)</code><code>(compile schema options)</code></div><div class="doc"><div class="markdown"><p>Compiles a schema, verifies its correctness, and prepares it for query execution. The compiled schema is in an entirely different format than the input schema.</p>
<p>The format of the compiled schema is subject to change without notice.</p>
<p>This function explicitly validates its arguments using clojure.spec.</p>
<p>Compile options:</p>
<dl>
<dt>:default-field-resolver</dt>
<dd>A function that accepts a field name (as a keyword) and converts it into the default field resolver; this defaults to <a href="com.walmartlabs.lacinia.schema.html#var-default-field-resolver">default-field-resolver</a>.</dd>
<dt>:promote-nils-to-empty-list?</dt>
<dd>Returns the prior, incorrect behavior, where a list field that resolved to nil would be “promoted” to an empty list. This may be necessary when existing clients rely on the incorrect behavior, which was fixed in 0.31.0.</dd>
<dt>:enable-introspection?</dt>
<dd>If true (the default), then Schema introspection is enabled. Some applications may disable introspection in production.</dd>
<dt>:executor (added in 1.2)</dt>
<dd>An instance of java.util.concurrent.Executor; this will be used during query execution, primarily when <a href="com.walmartlabs.lacinia.resolve.html#var-resolve-promise">resolve-promise</a> callbacks are invoked. If omitted, a default ThreadPoolExecutor is supplied.</dd>
<dt>:disable-checks?  (added in 1.1)</dt>
<dd>If true (defaults to false), certain runtime checks on data returned from field resolvers are omitted; this trades safety for speed, but may make sense when running in production.</dd>
<dt>:disable-java-objects? (added in 1.1)</dt>
<dd>Normally, Lacinia must check each returned field to see if it is a wrapper around a Java object (this happens when a Java objects is tagged via <a href="com.walmartlabs.lacinia.schema.html#var-tag-with-type">tag-with-type</a>); in most applications, resolvers return only Clojure values, not Java objects, and the step that looks for tagged values iis only needed for fields whose type is an interface or union. Using this option improves performance slightly, but should be used consistently across environments (testing and production).</dd>
<dt>:apply-field-directives</dt>
<dd>An optional callback function; for fields that have any directives on the field definition, the callback is invoked; it is passed the <a href="com.walmartlabs.lacinia.selection.html#var-FieldDef">FieldDef</a> (from which directives may be extracted) and the base field resolver function (possibly, a default field resolver). The callback may return a new field resolver function, or return nil to use the base field resolver function.</dd>
</dl>
<p>A <a href="com.walmartlabs.lacinia.resolve.html#var-FieldResolver">FieldResolver</a> instance is converted to a function before being passed to the callback.</p>
<p>The callback should be aware that the base resolver function may return a raw value, or a <a href="com.walmartlabs.lacinia.resolve.html#var-ResolverResult">ResolverResult</a>. Generally, this option is used with the <a href="com.walmartlabs.lacinia.resolve.html#var-wrap-resolver-result">wrap-resolver-result</a> function.</p>
<p>This processing occurs at the very end of schema compilation.</p>
<dl>
<dt>:apply-subscription-field-directives</dt>
<dd>An optional callback function; for subscription fields that have any directives on the field definition, the callback is invoked; it is passed the <a href="com.walmartlabs.lacinia.selection.html#var-FieldDef">FieldDef</a> (from which directives may be extracted) and the streamer function from the subscription definition. The callback may return a new streamer function, or return nil to use the existing streamer function.</dd>
</dl>
<p>This processing occurs at the very end of schema compilation.</p>
<p>Produces a form ready for use in executing a query.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L1988">view source</a></div></div><div class="public anchor" id="var-default-executor"><h3>default-executor</h3><h4 class="added">added in 1.2</h4><div class="usage"><code>(default-executor)</code></div><div class="doc"><div class="markdown"><p>Creates and returns a default executor used if one is not explicitly provided.</p>
<p>Returns an unbounded ThreadPoolExecutor, with a maximum of 10 threads, and a 1 second keep-alive.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L59">view source</a></div></div><div class="public anchor" id="var-default-field-resolver"><h3>default-field-resolver</h3><div class="usage"><code>(default-field-resolver field-name)</code></div><div class="doc"><div class="markdown"><p>The default for the :default-field-resolver option, this uses the field name as the key into the resolved value.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L1959">view source</a></div></div><div class="public anchor" id="var-default-scalar-transformers"><h3>default-scalar-transformers</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L272">view source</a></div></div><div class="public anchor" id="var-hyphenating-default-field-resolver"><h3>hyphenating-default-field-resolver</h3><h4 class="added">added in 0.17.0</h4><div class="usage"><code>(hyphenating-default-field-resolver field-name)</code></div><div class="doc"><div class="markdown"><p>An alternative to <a href="com.walmartlabs.lacinia.schema.html#var-default-field-resolver">default-field-resolver</a>, this converts underscores in the field name into hyphens.  At one time, this was the default behavior.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L1968">view source</a></div></div><div class="public anchor" id="var-is-coercion-failure.3F"><h3>is-coercion-failure?</h3><h4 class="added">added in 0.16.0</h4><div class="usage"><code>(is-coercion-failure? v)</code></div><div class="doc"><div class="markdown"><p>Is this a coercion error created by <a href="com.walmartlabs.lacinia.schema.html#var-coercion-failure">coercion-failure</a>?</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L101">view source</a></div></div><div class="public anchor" id="var-select-type"><h3>select-type</h3><h4 class="added">added in 0.39</h4><div class="usage"><code>(select-type compiled-schema type-name)</code></div><div class="doc"><div class="markdown"><p>Given a compiled schema and a keyword type name, returns a <a href="com.walmartlabs.lacinia.selection.html#var-TypeDef">TypeDef</a>, or nil if not found.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L491">view source</a></div></div><div class="public anchor" id="var-tag-with-type"><h3>tag-with-type</h3><div class="usage"><code>(tag-with-type x type-name)</code></div><div class="doc"><div class="markdown"><p>Tags a value with a GraphQL type name, a keyword. The keyword should identify a specific concrete object (not an interface or union) in the relevent schema.</p>
<p>In most cases, this is accomplished by modifying the value’s metadata.</p>
<p>For the more rare case, where a particular Java object is used rather than a Clojure map, this function returns a new wrapper instance that combines the value and the type name.</p>
</div></div><div class="src-link"><a href="https://github.com/walmartlabs/lacinia/blob/master/src/com/walmartlabs/lacinia/schema.clj#L118">view source</a></div></div></div></body></html>