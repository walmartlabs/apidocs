<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>com.walmartlabs.lacinia.pedestal documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Pedestal-lacinia</span> <span class="project-version">0.1.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="com.walmartlabs.lacinia.pedestal.html"><div class="inner"><span>com.walmartlabs.lacinia.pedestal</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-bad-request"><div class="inner"><span>bad-request</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-extract-query"><div class="inner"><span>extract-query</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-graphql-data-interceptor"><div class="inner"><span>graphql-data-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-graphql-routes"><div class="inner"><span>graphql-routes</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-json-response-interceptor"><div class="inner"><span>json-response-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-missing-query-interceptor"><div class="inner"><span>missing-query-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-pedestal-service"><div class="inner"><span>pedestal-service</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-query-executor-handler"><div class="inner"><span>query-executor-handler</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-query-parser-interceptor"><div class="inner"><span>query-parser-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-require-graphql-content-interceptor"><div class="inner"><span>require-graphql-content-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-status-conversion-interceptor"><div class="inner"><span>status-conversion-interceptor</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.lacinia.pedestal.html#var-variable-map"><div class="inner"><span>variable-map</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">com.walmartlabs.lacinia.pedestal</h1><div class="doc"><div class="markdown"><p>Defines Pedestal interceptors and supporting code.</p></div></div><div class="public anchor" id="var-bad-request"><h3>bad-request</h3><div class="usage"><code>(bad-request body)</code><code>(bad-request status body)</code></div><div class="doc"><div class="markdown"><p>Generates a bad request Ring response.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L14">view source</a></div></div><div class="public anchor" id="var-extract-query"><h3>extract-query</h3><div class="usage"><code>(extract-query request)</code></div><div class="doc"><div class="markdown"><p>For GraphQL queries, returns the query document ready to be parsed.</p>
<p>For the GET method, this is expected to be a query parameter named <code>query</code>.</p>
<p>For the POST method, this is the body of the request.</p>
<p>For other methods, returns nil.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L23">view source</a></div></div><div class="public anchor" id="var-graphql-data-interceptor"><h3>graphql-data-interceptor</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Extracts the raw data (query and variables) from the request and validates that at least the query is present.</p>
<p>Adds two new request keys: :graphql-query and :graphql-vars.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L75">view source</a></div></div><div class="public anchor" id="var-graphql-routes"><h3>graphql-routes</h3><div class="usage"><code>(graphql-routes compiled-schema options)</code></div><div class="doc"><div class="markdown"><p>Creates default routes for handling GET and POST requests (at <code>/graphql</code>) and (optionally) the GraphiQL IDE (at <code>/</code>).</p>
<p>Returns a set of route vectors, compatible with <code>io.pedestal.http.route.definition.table/table-routes</code>.</p>
<p>The standard interceptor stack:</p>
<ul>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-json-response-interceptor">json-response-interceptor</a></li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-require-graphql-content-interceptor">require-graphql-content-interceptor</a> (for method POST)</li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-graphql-data-interceptor">graphql-data-interceptor</a></li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-missing-query-interceptor">missing-query-interceptor</a></li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-query-parser-interceptor">query-parser-interceptor</a></li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-status-conversion-interceptor">status-conversion-interceptor</a></li>
  <li><a href="com.walmartlabs.lacinia.pedestal.html#var-query-executor-handler">query-executor-handler</a></li>
</ul>
<p>Options:</p>
<dl>
  <dt>:graphiql (default false)
  </dt>
  <dd>If true, enables routes for the GraphiQL IDE.</dd>
  <dt>:app-context
  </dt>
  <dd>The base application context provided to Lacinia when executing a query.</dd>
</dl></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L172">view source</a></div></div><div class="public anchor" id="var-json-response-interceptor"><h3>json-response-interceptor</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An interceptor that sees if the response body is a map and, if so, converts the map to JSON and sets the response Content-Type header.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L49">view source</a></div></div><div class="public anchor" id="var-missing-query-interceptor"><h3>missing-query-interceptor</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Rejects the request when there’s no GraphQL query (via the <a href="com.walmartlabs.lacinia.pedestal.html#var-graphql-data-interceptor">graphql-data-interceptor</a>).</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L91">view source</a></div></div><div class="public anchor" id="var-pedestal-service"><h3>pedestal-service</h3><div class="usage"><code>(pedestal-service compiled-schema options)</code></div><div class="doc"><div class="markdown"><p>Creates and returns a Pedestal service map, ready to be started. This uses a server type of :jetty.</p>
<p>Options:</p>
<dl>
  <dt>:graphql (default: false)
  </dt>
  <dd>If given, then enables resources to support the GraphiQL IDE</dd>
  <dt>:port (default: 8888)
  </dt>
  <dd>HTTP port to use.</dd>
  <dt>:env (default: :dev)
  </dt>
  <dd>Environment being started.</dd>
</dl></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L221">view source</a></div></div><div class="public anchor" id="var-query-executor-handler"><h3>query-executor-handler</h3><div class="usage"><code>(query-executor-handler app-context)</code></div><div class="doc"><div class="markdown"><p>The handler at the end of interceptor chain, invokes Lacinia to execute the query and return the main response.</p>
<p>The handler adds the Ring request map as the :request key to the provided app-context before executing the query.</p>
<p>This comes after <a href="com.walmartlabs.lacinia.pedestal.html#var-query-parser-interceptor">query-parser-interceptor</a> and <a href="com.walmartlabs.lacinia.pedestal.html#var-status-conversion-interceptor">status-conversion-interceptor</a> in the interceptor chain.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L142">view source</a></div></div><div class="public anchor" id="var-query-parser-interceptor"><h3>query-parser-interceptor</h3><div class="usage"><code>(query-parser-interceptor schema)</code></div><div class="doc"><div class="markdown"><p>Given an schema, returns an interceptor that parses the query.</p>
<p>Expected to come after <a href="com.walmartlabs.lacinia.pedestal.html#var-missing-query-interceptor">missing-query-interceptor</a> in the interceptor chain.</p>
<p>Adds a new reuest key, :parsed-lacinia-query.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L103">view source</a></div></div><div class="public anchor" id="var-require-graphql-content-interceptor"><h3>require-graphql-content-interceptor</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An interceptor that verifies that the incoming content type is “application/graphql”.</p>
<p>This should only appear in the interceptor stack for the POST method.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L62">view source</a></div></div><div class="public anchor" id="var-status-conversion-interceptor"><h3>status-conversion-interceptor</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Checks to see if any error map in the :errors key of the response contains a :status value. If so, the maximum status value of such errors is found and used as the status of the overall response, and the :status key is dissoc’ed from all errors.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L123">view source</a></div></div><div class="public anchor" id="var-variable-map"><h3>variable-map</h3><div class="usage"><code>(variable-map request)</code></div><div class="doc"><div class="markdown"><p>Converts the <code>variables</code> query parameter into Clojure data by parsing as JSON.</p>
<p>Returns the variables map (with keyword keys) or nil not found.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/pedestal-lacinia/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L41">view source</a></div></div></div></body></html>