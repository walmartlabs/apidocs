<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>com.walmartlabs.test-reporting documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Test-reporting</span> <span class="project-version">1.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="com.walmartlabs.test-reporting.html"><div class="inner"><span>com.walmartlabs.test-reporting</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="com.walmartlabs.test-reporting.html#var-*reported.3F"><div class="inner"><span>*reported?</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.test-reporting.html#var-*reporting-context*"><div class="inner"><span>*reporting-context*</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.test-reporting.html#var-report-context"><div class="inner"><span>report-context</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.test-reporting.html#var-reporting"><div class="inner"><span>reporting</span></div></a></li><li class="depth-1"><a href="com.walmartlabs.test-reporting.html#var-snapshot-counters"><div class="inner"><span>snapshot-counters</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">com.walmartlabs.test-reporting</h1><div class="doc"><div class="markdown"><p>An extension for clojure.test that allows additional context to be output only when a test failure or error occurs.</p></div></div><div class="public anchor" id="var-*reported.3F"><h3>*reported?</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Used to prevent multiple reports of the context. This flag is set to true when <a href="com.walmartlabs.test-reporting.html#var-*reporting-context*">*reporting-context*</a> is bound with new data, and reset to false when the context is printed out.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/test-reporting/blob/master/src/com/walmartlabs/test_reporting.clj#L34">view source</a></div></div><div class="public anchor" id="var-*reporting-context*"><h3>*reporting-context*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Contains a map of additional information to be printed in the report when a test failure or error is observed.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/test-reporting/blob/master/src/com/walmartlabs/test_reporting.clj#L29">view source</a></div></div><div class="public anchor" id="var-report-context"><h3>report-context</h3><div class="usage"><code>(report-context)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/walmartlabs/test-reporting/blob/master/src/com/walmartlabs/test_reporting.clj#L47">view source</a></div></div><div class="public anchor" id="var-reporting"><h3>reporting</h3><h4 class="type">macro</h4><div class="usage"><code>(reporting data &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Establishes a context in which certain data is printed when the form (tests using the <code>is</code> macro) identify test failures or exceptions.</p>
<p>This adds keys to the <a href="com.walmartlabs.test-reporting.html#var-*reporting-context*">*reporting-context*</a>. After executing the forms, a check is made to see if the number of errors or failures changed; if so then the reporting context is pretty-printed to <code>*out*</code>.</p>
<p>The data maybe a symbol: The unevaluated symbol becomes the key, and the evaluated symbol is the value.</p>
<p>Alternately, data may be a map, which is merged into the context. In this form, keys must be quoted if symbols.</p>
<pre><code>(reporting request
    (is ...))
</code></pre>
<p>is the same as:</p>
<pre><code>(reporting {'request request}
   (is ...))
</code></pre>
<p>A final alternative is to report a vector; each of the symbols is quoted.</p>
<pre><code>(reporting [request response] ...)
</code></pre>
<p>is the same as:</p>
<pre><code>(reporting {'request request 'response response} ...)
</code></pre>
<p>Nested usages of reporting is allowed; a reasonable attempt is made to prevent the context from being printed multiple times when there are multiple failures. Typically, the context is only printed once, at the deepest nested block in which test failures occur.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/test-reporting/blob/master/src/com/walmartlabs/test_reporting.clj#L52">view source</a></div></div><div class="public anchor" id="var-snapshot-counters"><h3>snapshot-counters</h3><div class="usage"><code>(snapshot-counters)</code></div><div class="doc"><div class="markdown"><p>Returns just the :fail and :error keys from the <code>*report-counters*</code> var. A change to either of these values indicates a test failure, triggering the reporting of context.</p></div></div><div class="src-link"><a href="https://github.com/walmartlabs/test-reporting/blob/master/src/com/walmartlabs/test_reporting.clj#L40">view source</a></div></div></div></body></html>